<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Basic meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Site meta tags -->
    <title>{% block title %}IES Las Fuentezuelas{% endblock %}</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <!-- Modern CSS Styles -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            color: #343a40;
        }
        .nav-tabs .nav-link {
            border: 1px solid transparent;
            border-top-left-radius: .25rem;
            border-top-right-radius: .25rem;
            background-color: #e9ecef;
            color: #495057;
        }
        .nav-tabs .nav-link.active {
            color: #007bff;
            background-color: #fff;
            border-color: #dee2e6 #dee2e6 #fff;
        }
        .tab-content > .tab-pane {
            display: none;
        }
        .tab-content > .active {
            display: block;
        }
        .nav-link.disabled {
            pointer-events: none;
            color: #6c757d;
            background-color: #e9ecef;
        }
        .styled[disabled] {
            background-color: gray;
            color: white;
            cursor: not-allowed;
        }
        .hidden {
            display: none;
        }

        #ponentesAgregados {
    border: 1px solid #ccc;
    padding: 10px;
    margin-top: 20px;
    background-color: #f9f9f9;
    border-radius: 5px;
}

#ponentesAgregados div {
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
    background-color: #fff;
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#ponentesAgregados div:nth-child(even) {
    background-color: #f1f1f1;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
}

.form-group input[type="text"] {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

.form-group input.styled {
    background-color: #007bff;
    color: #fff;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 4px;
    transition: background-color 0.3s ease;
}

.form-group input.styled:hover {
    background-color: #0056b3;
}

    </style>
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="{{ asset('css/responsive.css') }}">
    <link rel="stylesheet" href="{{ asset('css/pestaña/s.css') }}">
    <!-- Favicon -->
    <link rel="icon" href="{{ asset('images/fevicon.png') }}" type="image/gif" />
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="{{ asset('css/jquery.mCustomScrollbar.min.css') }}">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <!-- Fancybox -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
    <!-- MDBootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.0/mdb.min.css" />
    {% block stylesheets %}{% endblock %}
</head>
<body class="main-layout">
    <!-- Tabs navs -->
    <ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="ex1-tab-1" data-mdb-toggle="tab" href="#ex1-tabs-1" role="tab" aria-controls="ex1-tabs-1" aria-selected="true">Actividad</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="ex1-tab-2" data-mdb-toggle="tab" href="#ex1-tabs-2" role="tab" aria-controls="ex1-tabs-2" aria-selected="false">Recursos</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="ex1-tab-3" data-mdb-toggle="tab" href="#ex1-tabs-3" role="tab" aria-controls="ex1-tabs-3" aria-selected="false">Ponentes</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="ex1-tab-4" data-mdb-toggle="tab" href="#ex1-tabs-4" role="tab" aria-controls="ex1-tabs-4" aria-selected="false">Grupos</a>
        </li>
    </ul>
    <!-- Tabs navs -->

    <!-- Tabs content -->
    <div class="tab-content" id="ex1-content">
        <div class="tab-pane fade show active" id="ex1-tabs-1" role="tabpanel" aria-labelledby="ex1-tab-1">
            <div class="tab-content">

                <form class="form-container" method="post" action="{{ path('app_pestañas') }}">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="actividad-select">Actividad</label>
                            <select name="actividad" id="actividad-select">
                                <option value="compuesta">Compuesta</option>
                                <option value="simple">Simple</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="id">ID</label>
                            <input type="number" id="idd" name="id" disabled>
                        </div>
                        <div class="form-row" id="titulo-container" style="display: none;">
                            <div class="form-group full-width">
                                <label for="titulo">Título</label>
                                <input type="text" id="titulo" name="titulo">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="aforo">Aforo</label>
                            <input type="number" id="aforo" name="aforo" min="1" step="1">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="inicio">Inicio</label>
                            <input type="date" id="inicio" name="inicio">
                        </div>
                        <div class="form-group">
                            <label for="fin">Fin</label>
                            <input type="date" id="fin" name="fin">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="evento">Evento</label>
                        <select id="evento" name="evento">
                            <option value="">Seleccione un evento</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="descripcion">Descripción</label>
                            <textarea name="descripcion" id="descripcion" cols="30" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <input class="styled" type="submit" value="Guardar" id="g1">
                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                    </symbol>
                    </svg>
                    <div class="alert alert-warning d-flex align-items-center hidden" role="alert" id="alerta">
                        <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:"><use xlink:href="#exclamation-triangle-fill"/></svg>
                        <div>
                            Debes rellenas todas las pestañas para añadir una actividad
                        </div>
                    </div>
                </form>
            </div> 
        </div>

        <div class="tab-pane fade" id="ex1-tabs-2" role="tabpanel" aria-labelledby="ex1-tab-2">
            <table id="form-table">
        <tr>
            <td>
                <select class="select-box" name="fuente" id="fuente" size="20" multiple="multiple"></select>
            </td>
            <td>
                <select class="select-box" name="seleccionados" id="seleccionados" size="20" multiple="multiple"></select>
            </td>
        </tr>
    </table>
        </div>

        <div class="tab-pane fade" id="ex1-tabs-3" role="tabpanel" aria-labelledby="ex1-tab-3">
            <form class="form-container">
                <div class="form-group">
                    <label for="nombre">Nombre</label>
                    <input type="text" id="nombre" name="nombre">
                </div>
                <div class="form-group">
                    <label for="cargo">Cargo</label>
                    <input type="text" id="cargo" name="cargo">
                </div>
                <div class="form-group">
                    <label for="recurso">Recurso</label>
                    <input type="text" id="recurso" name="recurso">
                </div>
                <div class="form-group">
                    <input class="styled" type="button" value="Añadir Ponente" id="guardarPonente">
                </div>
            </form>
            <form class="form-container">
                <div id="ponentesAgregados"></div>
            </form>
        </div>

        <div class="tab-pane fade" id="ex1-tabs-4" role="tabpanel" aria-labelledby="ex1-tab-4">
            <div class="tab-content">
                <div id="checkboxes-container"></div>
            </div>
            <input class="styled" type="button" value="Guardar" id="g2"/>
        </div>
    </div>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.0/mdb.min.js"></script>  
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var tabs = document.querySelectorAll('[data-mdb-toggle="tab"]');
            var btnGuardarSimple = document.getElementById('g1');
            var flexShrinkDiv = document.getElementById('alerta');
            var actividadSelect = document.getElementById('actividad-select');
            var tabLinks = document.querySelectorAll('.nav-link');

            tabs.forEach(function(tab) {
                tab.addEventListener('click', function(event) {
                    event.preventDefault();
                    var target = document.querySelector(tab.getAttribute('href'));
                    var allContent = document.querySelectorAll('.tab-pane');
                    allContent.forEach(function(content) {
                        content.classList.remove('show', 'active');
                    });
                    target.classList.add('show', 'active');
                });
            });

            actividadSelect.addEventListener('change', function() {
                if (actividadSelect.value === 'simple') {
                    btnGuardarSimple.classList.add('hidden');
                    flexShrinkDiv.classList.remove('hidden');
                    tabLinks.forEach(function(link, index) {
                        if (index > 0) { 
                            link.classList.remove('disabled');
                        }
                    });
                } else if (actividadSelect.value === 'compuesta') {
                    btnGuardarSimple.classList.remove('hidden');
                    flexShrinkDiv.classList.add('hidden');
                    tabLinks.forEach(function(link, index) {
                        if (index > 0) { 
                            link.classList.add('disabled');
                        }
                    });
                }
            });

            actividadSelect.dispatchEvent(new Event('change'));
        });

        document.getElementById('fuente').addEventListener('change', function() {
    var seleccionados = Array.from(this.selectedOptions).map(option => option.value);

    if (seleccionados.length === 0) {
        console.error('No se han seleccionado recursos');
        return;
    }

    var url = '/API/salas?recursos=' + seleccionados.join(',');

    console.log('URL construida:', url);

    fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            var select = document.getElementById('seleccionados');
            select.innerHTML = '';

            if (data.length === 0) {
                console.log('No se encontraron salas para los recursos seleccionados.');
                return;
            }

            data.forEach(function(sala) {
                var option = document.createElement('option');
                option.value = sala.id;
                option.textContent = sala.nombre;
                select.appendChild(option);
            });
        })
        .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
        });
});
    </script>
    {% block javascripts %}
        <script src="js/jsAltaMasiva/pestaña.js"></script>
        <script src="js/jsAltaMasiva/tablas.js"></script>
        <script src="js/pestaña/agregaActividad.js"></script>
        <script src="js/pestaña/agregaPonente.js"></script>
    {% endblock %}
</body>
</html>
